function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],n=!0,r=!1,l=void 0;try{for(var c,o=e[Symbol.iterator]();!(n=(c=o.next()).done)&&(a.push(c.value),!t||a.length!==t);n=!0);}catch(e){r=!0,l=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw l}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cdm_core.fn.docReady((function(){return build_salesagentfinder()}));var build_salesagentfinder=function(){if(document.querySelector(".wp-block-exm-sales-agent-finder .agents")&&"object"===("undefined"==typeof google?"undefined":_typeof(google))&&"object"===_typeof(google.maps)){var e=function(e){i.markers.forEach((function(t){t.agent.id==e&&i.togglemarker(t)}))},t=new google.maps.Geocoder,a=null,n="",r=0,l=null,c="",o=function(e){return e*Math.PI/180},s=function(){var t=new google.maps.LatLngBounds,a=!1;if(i.markers.forEach((function(e){var c,s,i,m,d;""!==n?(c=e.position,s=l.center,i=o(s.lat()-c.lat()),m=o(s.lng()-c.lng()),d=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o(c.lat()))*Math.cos(o(s.lat()))*Math.sin(m/2)*Math.sin(m/2),2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))*6378137<=1e3*r?(e.setVisible(!0),a=!0,t.extend(e.getPosition()),0):e.setVisible(!1)):(e.setVisible(!0),a=!0,t.extend(e.getPosition()),0)})),a&&null!==l){var c=l.getRadius()/200;map.setZoom(Math.ceil(16-Math.log(c)/Math.log(2)))}cdm_core.react.render(React.createElement(List,{markers:i.markers,find:e}),document.querySelector(".wp-block-exm-sales-agent-finder .agents"))};cdm_core.react.render(React.createElement(Filters,{onfilter:function(e){n=e.postal,r=e.range,c==n?(null!==l&&l.setRadius(1e3*r),s()):n?a||t.geocode({address:n},(function(e,t){t==google.maps.GeocoderStatus.OK?(i.setCenter(e[0].geometry.location),null!==l&&l.setMap(null),l=new google.maps.Circle({center:e[0].geometry.location,map:i,strokeColor:"#c79153",strokeWeight:1,strokeOpacity:.5,fillColor:"#c79153",fillOpacity:.4,radius:1e3*r,is_circle:!0}),s(),c=n,a=!1):(c=n,a=!1)})):(l.setMap(null),s())}}),document.querySelector(".wp-block-exm-sales-agent-finder .filters"));var i=initMap();s()}},List=function(e){var t=React.useRef(!0);React.useLayoutEffect((function(){t.current&&(t.current=!1)}));var a=cdm_core.components.Conditional,n=cdm_core.components.Collapsible,r=cdm_core.react.fragment,l=0;return React.createElement(r,null,e.markers.map((function(t){if(t.visible)return l++,React.createElement(n,{title:cdm_core.fn.HTMLEntities(t.agent.title)},React.createElement(Agent,{find:e.find,agent:t.agent}))})),React.createElement(a,{condition:0==l},React.createElement("p",{class:"noresult"},salesagentfinder_data.lang.noresult)))},Filters=function(e){var t=cdm_core.components.Conditional,a=_slicedToArray(cdm_core.react.useState(100),2),n=a[0],r=a[1],l=_slicedToArray(cdm_core.react.useState(""),2),c=l[0],o=l[1],s=function(t){n+t<=500&&n+t>=1&&(r(n+t),e.onfilter({postal:c,range:n+t}))};return React.createElement("div",null,React.createElement("span",{class:"form-wrapper"},React.createElement("input",{value:c,onInput:function(t){o(t.target.value),e.onfilter({postal:t.target.value,range:n})},type:"text",placeholder:salesagentfinder_data.lang.postal}),React.createElement("button",null,React.createElement("i",{class:"fa fa-search"}))),React.createElement("span",{class:"ranger-wrapper"},React.createElement("span",{class:"title"},"Max distance: ",n,"Km ",React.createElement(t,{condition:100!==n||""!==c}," ",React.createElement("span",{onClick:function(t){o(""),r(100),e.onfilter({postal:"",range:100})},class:"reset"},salesagentfinder_data.lang.reset)," ")," "),React.createElement("span",{class:"wrap-add"},React.createElement("span",{onClick:function(){return s(-5)},class:"moins"},"-"),React.createElement("input",{type:"range",min:1,max:500,value:n,onChange:function(t){r(+t.target.value),e.onfilter({postal:c,range:+t.target.value})},class:"slider",id:"myRange"}),React.createElement("span",{onClick:function(){return s(5)},class:"plus"},"+"))))},Agent=function(e){var t,a=cdm_core.components.Conditional;return React.createElement(a,{condition:null!==e.agent.address.address&&!1!==e.agent.address.address},React.createElement("div",null,React.createElement("p",{className:"address-link"},React.createElement("span",{onClick:function(){return e.find(e.agent.id)}},cdm_core.fn.HTMLEntities(e.agent.title)),React.createElement("a",{target:"_blank",href:"https://www.google.com/maps/search/?api=1&query="+encodeURI(e.agent.address.address)},salesagentfinder_data.lang.open,React.createElement("i",{className:"far fa-external-link"}))),React.createElement("p",{className:"contacts"},React.createElement(a,{condition:""!==e.agent.name},React.createElement("span",{class:"title"},salesagentfinder_data.lang.Contact,": "),React.createElement("span",null,cdm_core.fn.HTMLEntities(e.agent.name)),React.createElement("br",null)),React.createElement(a,{condition:""!==e.agent.phone},React.createElement("span",{class:"title"},salesagentfinder_data.lang.Telephone,": "),React.createElement("a",{href:"tel:"+e.agent.phone.split("").filter((function(e){return!["-"," ","(",")"].includes(e)})).join("")},e.agent.phone),React.createElement("br",null)),React.createElement(a,{condition:""!==e.agent.cell_phone},React.createElement("span",{class:"title"},salesagentfinder_data.lang.Cell," phone: "),React.createElement("a",{href:"tel:"+e.agent.phone.split("").filter((function(e){return!["-"," ","(",")"].includes(e)})).join("")},e.agent.cell_phone),React.createElement("br",null)),React.createElement(a,{condition:""!==e.agent.fax},React.createElement("span",{class:"title"},salesagentfinder_data.lang.Fax,": "),React.createElement("a",{href:"tel:"+e.agent.phone.split("").filter((function(e){return!["-"," ","(",")"].includes(e)})).join("")},e.agent.fax),React.createElement("br",null)),React.createElement(a,{condition:""!==e.agent.email},React.createElement("span",{class:"title"},salesagentfinder_data.lang.Email,": "),React.createElement("a",{href:"mailto:"+e.agent.email},e.agent.email),React.createElement("br",null)),React.createElement(a,{condition:""!==e.agent.website},React.createElement("span",{class:"title"},salesagentfinder_data.lang.Website,": "),React.createElement("a",{rel:"noopener",target:"_blank",href:(t=e.agent.website,/^(?:f|ht)tps?\:\/\//.test(t)||(t="https://"+t),t)},e.agent.website),React.createElement("br",null)),React.createElement(a,{condition:""!==e.agent.address.address},React.createElement("span",{class:"title"},salesagentfinder_data.lang.Address,": "),React.createElement("a",{target:"_blank",href:"https://www.google.com/maps/search/?api=1&query="+encodeURI(e.agent.address.address)},e.agent.address.address),React.createElement("br",null)))))};function initMap(){map=new google.maps.Map(document.getElementById("contactmap"),{center:{lat:-34.397,lng:150.644},zoom:8,mapTypeId:"custom_style",disableDefaultUI:!0,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"custom_style"]}}),map.mapTypes.set("custom_style",new google.maps.StyledMapType(GOOGLEMAP_CONFIG.style,{name:"Custom Style"}));var e=new google.maps.LatLngBounds;return map.markers=salesagentfinder_data.agents.map((function(t){if(!1!==t.address&&null!==t.address)return e.extend(new google.maps.LatLng(t.address.lat,t.address.lng)),new google.maps.Marker({position:new google.maps.LatLng(t.address.lat,t.address.lng),map:map,agent:t,infowindow:new google.maps.InfoWindow({content:document.createElement("div")}),title:t.address.address})})),map.fitBounds(e,50),map.togglemarker=function(e){map.panTo(e.getPosition()),map.setZoom(12),map.markers.forEach((function(e){e.infowindow.close()})),e.infowindow.open(map,e),cdm_core.react.render(React.createElement(Agent,{agent:e.agent}),e.infowindow.getContent())},map.markers.forEach((function(e){e.addListener("click",(function(){map.togglemarker(e)}))})),map}
//# sourceMappingURL=../../maps/gutenberg_blocks/sales-agent-finder/sales-agent-finder-render.min.js.map
