{"version":3,"sources":["gutenberg_blocks/knowledgebase/knowledgebase-render.js"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Array","from","isArray","_arrayLikeToArray","_slicedToArray","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","o","minLen","n","Object","prototype","toString","call","slice","constructor","name","test","len","length","arr2","r","l","t","e","u","a","f","next","done","push","value","return","cdm_core","fn","docReady","build_knowledgebase","document","querySelector","react","render","React","createElement","Knowledgebase","docs","knowledgebase_data","props","Fragment","fragment","_cdm_core$react$useSt2","useState","currentcat","setCurrentcat","_cdm_core$react$useSt4","router","setRouter","Conditional","components","useEffect","buildForm","undefined","hr","className","parentNode","insertBefore","nextSibling","fil_ariane","class","lang","howhelp","type","id","onChange","onKeyupHandlerSearch","placeholder","search","onClick","onClickHandlerSearch","base","href","preventDefault","navigateHistory","ariane_base","fil","flatMap","x","doc","filter","y","ID","HTMLEntities","concat","window","onpopstate","event","back","navigate","getElementById","target","get_current_level","parent_category","is_category","toLowerCase","replace","includes","to","index","indexOf","scrollIntoView","condition","map","Knowledgebase_cell","clickFn","image","file","title","empty","search_empty","ImageWP","open","url","src"],"mappings":"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","file":"../../../gutenberg_blocks/knowledgebase/knowledgebase-render.min.js","sourcesContent":["\ncdm_core.fn.docReady(()=>build_knowledgebase())\n\n\nconst build_knowledgebase = () => {\n  \n    \n    if(document.querySelector('.wp-block-exm-knowledgebase')){\n        cdm_core.react.render(<Knowledgebase docs={knowledgebase_data.docs} />,document.querySelector('.wp-block-exm-knowledgebase'));\n    }\n\n}\n\n\n\nconst Knowledgebase = (props)=>{\n    const Fragment = cdm_core.react.fragment;\n    const [currentcat,setCurrentcat] = cdm_core.react.useState(null);\n    const [router,setRouter] = cdm_core.react.useState([]);\n    const {Conditional} = cdm_core.components;\n    const search = '';\n\n    // passing an empty array as second argument triggers the callback in useEffect\n    // only after the initial render thus replicating `componentDidMount` lifecycle behaviour\n    React.useEffect(() => {\n        buildForm();\n        if(document.querySelector('.wrap-extra') !== undefined){\n            let hr = document.createElement('hr');\n            hr.className = \"p-0 m-0 has-color-2-background-color has-background\";\n            document.querySelector('.wrap-extra').parentNode.insertBefore(hr, document.querySelector('.wrap-extra').nextSibling);\n        }\n    }, []);\n    React.useEffect(() => {\n        fil_ariane();\n        \n    }) ;\n\n    const buildForm = function (){         \n        if(document.querySelector('banner-extra.content .right') !== undefined){\n            cdm_core.react.render(\n                <div class=\"search_box\"> \n                    <h4>{knowledgebase_data.lang.howhelp}</h4>\n                    <div class=\"form-wrapper\">\n                        <input type=\"text\" name=\"s\" id=\"search\" onChange={onKeyupHandlerSearch}  placeholder={knowledgebase_data.lang.search} /><button onClick={onClickHandlerSearch} class=\"search-knowledge\"><i class=\"fal fa-search\"></i></button>\n                    </div>\n                </div>\n            ,document.querySelector('.banner-extra.content .right'));\n        }\n    };\n\n\n\n    const fil_ariane = function(){\n        const base = [<a href=\"#\" onClick={(e)=>{e.preventDefault();navigateHistory(null)}} >{knowledgebase_data.lang.ariane_base}</a>]\n        const fil = router.flatMap(x=>{\n            const doc = props.docs.filter(y=>y.ID == x);\n            if(doc.length > 0){\n                return [<i class=\"fal fa-angle-right\" aria-hidden=\"true\"></i>,<a onClick={(e)=>{e.preventDefault();navigateHistory(doc[0].ID)}} href={doc[0].ID} >{cdm_core.fn.HTMLEntities(doc[0].name)}</a>]\n            }\n        });\n        let fil_ariane = base.concat(fil);\n        if(currentcat){\n            const doc = props.docs.filter(y=>y.ID == currentcat);\n            if(doc.length > 0){\n                fil_ariane = fil_ariane.concat([<i class=\"fal fa-angle-right\" aria-hidden=\"true\"></i>,<span>{cdm_core.fn.HTMLEntities(doc[0].name)}</span>]);\n            }\n        }\n\n        if(document.querySelector('div.breadcrumb') !== undefined){\n            cdm_core.react.render(\n                <Fragment>\n                    {fil_ariane}\n                </Fragment>\n            ,document.querySelector('div.breadcrumb'));\n        }\n    }\n\n\n    window.onpopstate = function(event) {\n        if(router.length > 0){\n            event.preventDefault();\n            back()\n        }\n    };\n    \n\n    const onClickHandlerSearch = () => {\n        navigate(document.getElementById('search').value)\n    }\n    const onKeyupHandlerSearch = (e) => {\n        navigate(e.target.value)\n    }\n    const get_current_level = () => {\n        let sorted = [];\n\n        if(currentcat == null){\n            sorted = props.docs.filter(x=>(x.parent_category == null || x.parent_category == 0) && x.is_category == true);\n        }else if(typeof currentcat == 'string'){\n            sorted = props.docs.filter(x=>(x.name.toLowerCase().replace(' ','').includes(currentcat.toLowerCase().replace(' ',''))));\n        }else {\n            sorted = props.docs.filter(x=>x.parent_category == currentcat );\n        }\n        return sorted;\n    }\n\n    const navigateHistory = (to)=>{\n        \n        const index = router.indexOf(to);\n        setRouter(router.slice(0,index))\n        setCurrentcat(to);\n    }\n\n    const navigate = (id)=>{\n        document.querySelector('.banner-top').scrollIntoView(true)\n        setRouter([...router,currentcat])\n        setCurrentcat(id);\n    }\n\n    const back = ()=>{\n        const to = router[router.length-1];\n        setRouter(router.filter(x => x!=to))\n        setCurrentcat(to);\n    }\n\n    const buildCells = ()=>{\n        return get_current_level().map(doc=>{\n            return <Knowledgebase_cell clickFn={navigate} image={doc.image} is_category={doc.is_category} file={doc.file} title={doc.name} id={doc.ID} />\n        })\n    }\n\n\n    return  <Fragment>\n                <Conditional condition={router.length > 0} >\n                    <button onClick={back} >{knowledgebase_data.lang.back}</button>\n                </Conditional>\n                <Conditional condition={typeof currentcat == 'string'} >\n                    <p class=\"empty\" > {currentcat}</p>\n                </Conditional>\n                <Conditional condition={get_current_level().length > 0} >\n                    <div>{buildCells()}</div>\n                </Conditional>\n                <Conditional condition={get_current_level().length == 0 && typeof currentcat != 'string'} >\n                    <p class=\"empty\" > {knowledgebase_data.lang.empty}</p>\n                </Conditional>\n                <Conditional condition={get_current_level().length == 0 && typeof currentcat == 'string'} >\n                    <p class=\"empty\" > {knowledgebase_data.lang.search_empty}</p>\n                </Conditional>\n            </Fragment>\n}\n\nconst Knowledgebase_cell = (props) => {\n\n    const clickBehavior = () => {\n        if(props.file == null || props.file == false){\n            props.clickFn(props.id)\n        }else{\n            open(props.file.url)\n        }\n    }\n\n    const {ImageWP} = cdm_core.components;\n    return  <div onClick={clickBehavior} > \n                <ImageWP src={props.image} />\n                <span>{cdm_core.fn.HTMLEntities(props.title)}</span>\n            </div>\n}\n\n"]}